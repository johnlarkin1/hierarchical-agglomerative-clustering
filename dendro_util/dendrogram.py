import numpy as np
from scipy.cluster.hierarchy import dendrogram
from matplotlib import pyplot as plt
import seaborn as sns

raw_data = [
    [0, 30, 0.0, 2],
    [400, 67, 0.0, 3],
    [401, 72, 0.0, 4],
    [402, 79, 0.0, 5],
    [403, 90, 0.0, 6],
    [404, 103, 0.0, 7],
    [405, 117, 0.0, 8],
    [406, 162, 0.0, 9],
    [407, 190, 0.0, 10],
    [408, 212, 0.0, 11],
    [409, 239, 0.0, 12],
    [410, 279, 0.0, 13],
    [411, 355, 0.0, 14],
    [412, 372, 0.0, 15],
    [413, 378, 0.0, 16],
    [414, 388, 0.0, 17],
    [2, 17, 0.0, 2],
    [416, 28, 0.0, 3],
    [417, 61, 0.0, 4],
    [418, 75, 0.0, 5],
    [419, 99, 0.0, 6],
    [420, 104, 0.0, 7],
    [421, 111, 0.0, 8],
    [422, 124, 0.0, 9],
    [423, 128, 0.0, 10],
    [424, 144, 0.0, 11],
    [425, 145, 0.0, 12],
    [426, 150, 0.0, 13],
    [427, 159, 0.0, 14],
    [428, 160, 0.0, 15],
    [429, 211, 0.0, 16],
    [430, 220, 0.0, 17],
    [431, 238, 0.0, 18],
    [432, 240, 0.0, 19],
    [433, 261, 0.0, 20],
    [434, 290, 0.0, 21],
    [435, 293, 0.0, 22],
    [436, 330, 0.0, 23],
    [3, 149, 0.0, 2],
    [438, 193, 0.0, 3],
    [4, 6, 0.0, 2],
    [440, 32, 0.0, 3],
    [441, 56, 0.0, 4],
    [442, 94, 0.0, 5],
    [443, 123, 0.0, 6],
    [444, 141, 0.0, 7],
    [445, 188, 0.0, 8],
    [446, 230, 0.0, 9],
    [7, 165, 0.0, 2],
    [10, 19, 0.0, 2],
    [449, 39, 0.0, 3],
    [450, 54, 0.0, 4],
    [451, 69, 0.0, 5],
    [452, 73, 0.0, 6],
    [453, 95, 0.0, 7],
    [454, 109, 0.0, 8],
    [455, 151, 0.0, 9],
    [456, 155, 0.0, 10],
    [457, 161, 0.0, 11],
    [458, 168, 0.0, 12],
    [459, 177, 0.0, 13],
    [460, 178, 0.0, 14],
    [461, 224, 0.0, 15],
    [462, 246, 0.0, 16],
    [463, 289, 0.0, 17],
    [464, 291, 0.0, 18],
    [465, 305, 0.0, 19],
    [466, 307, 0.0, 20],
    [467, 313, 0.0, 21],
    [468, 328, 0.0, 22],
    [469, 340, 0.0, 23],
    [470, 351, 0.0, 24],
    [471, 370, 0.0, 25],
    [472, 371, 0.0, 26],
    [12, 265, 0.0, 2],
    [14, 40, 0.0, 2],
    [475, 80, 0.0, 3],
    [476, 114, 0.0, 4],
    [477, 130, 0.0, 5],
    [478, 164, 0.0, 6],
    [479, 182, 0.0, 7],
    [480, 276, 0.0, 8],
    [481, 282, 0.0, 9],
    [482, 304, 0.0, 10],
    [483, 338, 0.0, 11],
    [484, 339, 0.0, 12],
    [485, 353, 0.0, 13],
    [486, 364, 0.0, 14],
    [15, 31, 0.0, 2],
    [488, 50, 0.0, 3],
    [489, 81, 0.0, 4],
    [490, 115, 0.0, 5],
    [491, 121, 0.0, 6],
    [492, 174, 0.0, 7],
    [493, 203, 0.0, 8],
    [494, 257, 0.0, 9],
    [495, 329, 0.0, 10],
    [496, 333, 0.0, 11],
    [497, 385, 0.0, 12],
    [18, 27, 0.0, 2],
    [499, 231, 0.0, 3],
    [500, 272, 0.0, 4],
    [501, 285, 0.0, 5],
    [502, 311, 0.0, 6],
    [503, 314, 0.0, 7],
    [504, 362, 0.0, 8],
    [505, 363, 0.0, 9],
    [506, 377, 0.0, 10],
    [507, 384, 0.0, 11],
    [508, 387, 0.0, 12],
    [20, 34, 0.0, 2],
    [510, 43, 0.0, 3],
    [511, 57, 0.0, 4],
    [512, 96, 0.0, 5],
    [513, 119, 0.0, 6],
    [514, 122, 0.0, 7],
    [515, 137, 0.0, 8],
    [516, 143, 0.0, 9],
    [517, 156, 0.0, 10],
    [518, 167, 0.0, 11],
    [519, 205, 0.0, 12],
    [520, 218, 0.0, 13],
    [521, 228, 0.0, 14],
    [522, 299, 0.0, 15],
    [523, 308, 0.0, 16],
    [524, 356, 0.0, 17],
    [525, 383, 0.0, 18],
    [22, 23, 0.0, 2],
    [527, 41, 0.0, 3],
    [528, 46, 0.0, 4],
    [529, 47, 0.0, 5],
    [530, 87, 0.0, 6],
    [531, 105, 0.0, 7],
    [532, 179, 0.0, 8],
    [533, 242, 0.0, 9],
    [534, 252, 0.0, 10],
    [535, 266, 0.0, 11],
    [536, 278, 0.0, 12],
    [537, 284, 0.0, 13],
    [538, 381, 0.0, 14],
    [539, 386, 0.0, 15],
    [29, 352, 0.0, 2],
    [35, 48, 0.0, 2],
    [542, 68, 0.0, 3],
    [543, 91, 0.0, 4],
    [544, 106, 0.0, 5],
    [545, 118, 0.0, 6],
    [546, 140, 0.0, 7],
    [547, 146, 0.0, 8],
    [548, 180, 0.0, 9],
    [549, 184, 0.0, 10],
    [550, 251, 0.0, 11],
    [551, 253, 0.0, 12],
    [552, 296, 0.0, 13],
    [553, 326, 0.0, 14],
    [554, 390, 0.0, 15],
    [36, 65, 0.0, 2],
    [556, 112, 0.0, 3],
    [557, 186, 0.0, 4],
    [558, 197, 0.0, 5],
    [559, 248, 0.0, 6],
    [560, 358, 0.0, 7],
    [37, 44, 0.0, 2],
    [562, 107, 0.0, 3],
    [563, 108, 0.0, 4],
    [564, 125, 0.0, 5],
    [565, 213, 0.0, 6],
    [566, 226, 0.0, 7],
    [567, 322, 0.0, 8],
    [568, 342, 0.0, 9],
    [569, 397, 0.0, 10],
    [38, 92, 0.0, 2],
    [571, 97, 0.0, 3],
    [572, 126, 0.0, 4],
    [573, 201, 0.0, 5],
    [574, 215, 0.0, 6],
    [575, 216, 0.0, 7],
    [576, 268, 0.0, 8],
    [577, 281, 0.0, 9],
    [578, 301, 0.0, 10],
    [579, 303, 0.0, 11],
    [580, 320, 0.0, 12],
    [581, 366, 0.0, 13],
    [582, 392, 0.0, 14],
    [52, 331, 0.0, 2],
    [584, 399, 0.0, 3],
    [55, 210, 0.0, 2],
    [60, 86, 0.0, 2],
    [587, 88, 0.0, 3],
    [588, 120, 0.0, 4],
    [589, 129, 0.0, 5],
    [590, 192, 0.0, 6],
    [591, 200, 0.0, 7],
    [592, 247, 0.0, 8],
    [593, 262, 0.0, 9],
    [594, 264, 0.0, 10],
    [595, 277, 0.0, 11],
    [596, 336, 0.0, 12],
    [597, 357, 0.0, 13],
    [70, 171, 0.0, 2],
    [71, 74, 0.0, 2],
    [78, 343, 0.0, 2],
    [89, 153, 0.0, 2],
    [110, 349, 0.0, 2],
    [116, 232, 0.0, 2],
    [604, 280, 0.0, 3],
    [605, 375, 0.0, 4],
    [138, 175, 0.0, 2],
    [607, 297, 0.0, 3],
    [158, 172, 0.0, 2],
    [609, 236, 0.0, 3],
    [166, 292, 0.0, 2],
    [176, 233, 0.0, 2],
    [185, 234, 0.0, 2],
    [187, 319, 0.0, 2],
    [198, 209, 0.0, 2],
    [615, 255, 0.0, 3],
    [616, 271, 0.0, 4],
    [617, 300, 0.0, 5],
    [618, 316, 0.0, 6],
    [619, 369, 0.0, 7],
    [620, 382, 0.0, 8],
    [621, 398, 0.0, 9],
    [269, 283, 0.0, 2],
    [623, 286, 0.0, 3],
    [624, 295, 0.0, 4],
    [625, 395, 0.0, 5],
    [415, 132, 1.0, 18],
    [627, 207, 1.0, 19],
    [437, 439, 1.0, 26],
    [447, 194, 1.0, 10],
    [5, 498, 1.0, 13],
    [448, 474, 1.0, 4],
    [473, 76, 1.0, 27],
    [11, 570, 1.0, 11],
    [634, 100, 1.0, 12],
    [487, 51, 1.0, 15],
    [16, 598, 1.0, 14],
    [509, 83, 1.0, 13],
    [638, 376, 1.0, 14],
    [526, 134, 1.0, 19],
    [640, 350, 1.0, 20],
    [641, 380, 1.0, 21],
    [540, 237, 1.0, 16],
    [26, 555, 1.0, 16],
    [644, 354, 1.0, 17],
    [583, 219, 1.0, 15],
    [585, 306, 1.0, 4],
    [58, 274, 1.0, 2],
    [64, 189, 1.0, 2],
    [84, 360, 1.0, 2],
    [135, 312, 1.0, 2],
    [136, 622, 1.0, 10],
    [181, 332, 1.0, 2],
    [637, 142, 1.0016548318980696, 15],
    [154, 652, 1.0023579476909998, 11],
    [633, 82, 1.003483942525708, 28],
    [631, 648, 1.0042708467227877, 15],
    [636, 170, 1.0055034272168113, 16],
    [655, 241, 1.0094378967911959, 12],
    [646, 270, 1.0246776623908909, 16],
    [658, 325, 1.0452442056524796, 17],
    [33, 635, 1.053209833462265, 13],
    [654, 368, 1.063435920825876, 16],
    [628, 249, 1.0645994644352552, 20],
    [662, 98, 1.0788003801647925, 14],
    [659, 391, 1.088222888799221, 13],
    [639, 148, 1.0955347155670514, 15],
    [657, 288, 1.0960081566374522, 16],
    [645, 393, 1.0998032763535326, 18],
    [660, 374, 1.1172175338474477, 17],
    [664, 321, 1.1189876581982259, 21],
    [667, 243, 1.1203240380406656, 16],
    [630, 229, 1.135190779499294, 11],
    [672, 379, 1.1566589345967726, 17],
    [668, 323, 1.1654211481320123, 17],
    [670, 223, 1.2130399951145932, 18],
    [669, 199, 1.2209429584761549, 19],
    [642, 651, 1.233194360185723, 23],
    [673, 396, 1.2785608305311984, 12],
    [678, 653, 1.3204109471671372, 25],
    [677, 345, 1.3450130448352595, 20],
    [675, 204, 1.353964102581584, 18],
    [561, 629, 1.8838412675371101, 33],
    [683, 632, 2.0, 37],
    [684, 541, 2.0, 39],
    [685, 608, 2.0, 42],
    [686, 610, 2.0, 45],
    [9, 53, 2.0, 2],
    [13, 49, 2.0, 2],
    [21, 309, 2.0, 2],
    [24, 208, 2.0, 2],
    [25, 77, 2.0, 2],
    [45, 603, 2.0, 3],
    [63, 337, 2.0, 2],
    [599, 606, 2.0, 6],
    [695, 626, 2.0, 11],
    [600, 614, 2.0, 4],
    [131, 183, 2.0, 2],
    [152, 260, 2.0, 2],
    [611, 202, 2.0, 3],
    [700, 394, 2.0, 4],
    [173, 359, 2.0, 2],
    [613, 235, 2.0, 3],
    [217, 365, 2.0, 2],
    [227, 389, 2.0, 2],
    [267, 344, 2.0, 2],
    [335, 346, 2.0, 2],
    [656, 139, 2.0082487061321586, 29],
    [643, 334, 2.048696150933651, 17],
    [708, 361, 2.0522331761055823, 30],
    [665, 691, 2.0767904482443122, 16],
    [663, 214, 2.1108844393995803, 17],
    [661, 273, 2.1335175083073996, 18],
    [671, 221, 2.142449649558187, 22],
    [689, 674, 2.1717878998725797, 19],
    [666, 287, 2.172656804786448, 14],
    [315, 702, 2.1875, 3],
    [705, 681, 2.217426241287653, 22],
    [711, 324, 2.229148996453831, 17],
    [102, 676, 2.2686627464738844, 19],
    [709, 195, 2.2768908594661643, 18],
    [712, 327, 2.2921813287069654, 18],
    [715, 586, 2.315027957972093, 21],
    [690, 682, 2.329491305645347, 20],
    [680, 347, 2.3871442417623787, 26],
    [679, 310, 2.43286382123774, 13],
    [720, 649, 2.5612563360388365, 21],
    [688, 101, 2.625, 3],
    [726, 706, 2.713349189374251, 15],
    [701, 258, 2.8610253772290806, 5],
    [687, 725, 2.881878835077376, 71],
    [692, 62, 3.0, 3],
    [693, 294, 3.0, 4],
    [59, 113, 3.0, 2],
    [601, 163, 3.0, 3],
    [735, 298, 3.0, 4],
    [85, 244, 3.0, 2],
    [737, 373, 3.0, 3],
    [698, 133, 3.0, 3],
    [147, 191, 3.0, 2],
    [696, 731, 3.0239895823588276, 82],
    [723, 263, 3.054595639474389, 22],
    [710, 694, 3.0688707408611, 32],
    [714, 697, 3.1019195592369626, 26],
    [717, 718, 3.23131776841486, 25],
    [721, 42, 3.23488309299447, 19],
    [738, 713, 3.23950809459288, 21],
    [722, 728, 3.269198372877874, 21],
    [727, 707, 3.2725900112442927, 23],
    [704, 743, 3.2857643062606967, 34],
    [746, 254, 3.2889557041418644, 20],
    [66, 724, 3.301699077291545, 21],
    [716, 699, 3.325352512584764, 16],
    [749, 736, 3.3378234435024927, 27],
    [719, 739, 3.393709940191802, 20],
    [733, 729, 3.4636598720383813, 19],
    [732, 753, 3.5297714811591407, 19],
    [1, 752, 3.5663028233782774, 22],
    [745, 275, 3.574165472962561, 26],
    [741, 602, 3.601136134018409, 84],
    [127, 744, 3.7032661239068307, 27],
    [734, 758, 3.9368873702268643, 24],
    [206, 317, 4.0, 2],
    [225, 245, 4.0, 2],
    [8, 761, 4.13089595386957, 28],
    [747, 764, 4.148014966083656, 23],
    [742, 763, 4.215243138904035, 24],
    [756, 157, 4.238942227689442, 20],
    [760, 703, 4.251386837100127, 87],
    [750, 302, 4.300089492271296, 35],
    [196, 759, 4.30712009191162, 27],
    [751, 341, 4.326913491533822, 21],
    [755, 250, 4.334228507650519, 21],
    [768, 256, 4.379157280627037, 21],
    [762, 169, 4.3965650938926535, 25],
    [757, 367, 4.399585552883386, 20],
    [765, 612, 4.619946421229528, 30],
    [766, 771, 4.711763064112028, 50],
    [647, 730, 4.7808191692658575, 9],
    [769, 770, 5.023041027573573, 122],
    [650, 774, 5.204270584601737, 23],
    [775, 259, 5.419413409076046, 26],
    [776, 740, 5.452893029216359, 22],
    [773, 348, 5.523656594603324, 22],
    [779, 778, 5.575790205072181, 59],
    [772, 318, 5.609623026510848, 22],
    [780, 785, 5.870761741025963, 181],
    [782, 222, 5.996431878532658, 27],
    [754, 767, 6.59866419353779, 51],
    [789, 787, 6.953832890107214, 232],
    [788, 781, 7.171752708836369, 50],
    [783, 790, 7.366132644726101, 254],
    [93, 777, 7.883594281243638, 31],
    [784, 786, 8.460434098385669, 44],
    [791, 792, 8.712151623469095, 304],
    [794, 793, 9.075626487403287, 75],
    [796, 795, 9.360186081443572, 379],
    [748, 797, 9.86069618106958, 400],
]

sns.set_style("darkgrid")
plt.figure(figsize=(10, 7))
linkage_matrix = np.array(raw_data)
n_clusters = linkage_matrix.shape[0] + 1
labels = [f"Sample {i+1}" for i in range(n_clusters)]

# Plotting the dendrogram
dendrogram(
    linkage_matrix,
    orientation="top",
    labels=labels,
    distance_sort="descending",
    show_leaf_counts=True,
    leaf_rotation=90.0,
    leaf_font_size=8.0,
    color_threshold=0.7 * max(linkage_matrix[:, 2]),
    above_threshold_color="grey",
)

plt.title("Hierarchical Clustering Dendrogram", fontsize=16)
plt.xlabel("Index", fontsize=10)
plt.ylabel("Distance", fontsize=14)
plt.show()
